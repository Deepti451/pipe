<apex:page tabStyle="Weather__tab" controller="Weather" sidebar="false" >
   
    <style>
       .statusStyle {
            background: url(/img/loading.gif) no-repeat 0 0;
            padding-left: 28px;
            margin-left: 680px;
            margin-top: 20px;
            line-height: 40px;
            background-size: 22px 22px;
            position: fixed;
       }
    </style>
    <apex:sectionheader subtitle="Weather Search"></apex:sectionheader>
    
    <apex:form id="form">
            <apex:pagemessages />
            <apex:actionStatus id="actionStatus" startText=" Please Wait " stopText=""  startStyleClass="statusStyle"/>
            <apex:pageBlock title="Place & Date Information">
                <apex:pageBlockButtons location="top" title="Get Weather History" >
                    <apex:commandButton style="font-size: 15px;" value="Get Weather History" action="{!getWeatherHistory}" reRender="form" status="actionStatus"/>
                </apex:pageBlockButtons>
                <apex:pageBlockSection columns="1" >
                    <apex:pageblockSectionItem >
                        City Name  <apex:inputField value="{!weatherHistory.City_Name__c}" />
                    </apex:pageblockSectionItem>
                
                    <apex:pageblockSectionItem >
                        Start Date  <apex:inputField value="{!weatherHistory.Start_Date__c}" />
                    </apex:pageblockSectionItem>
                
                    <apex:pageblockSectionItem >
                        End Date  <apex:inputField value="{!weatherHistory.End_Date__c}" />
                    </apex:pageblockSectionItem>
                </apex:pageBlockSection>
            </apex:pageBlock>
        
       <apex:pageBlock rendered="{!renderWeatherRecords}">
           <apex:pageBlockButtons location="top" rendered="{!if(WeathersList != null && WeathersList.size > 0,true, false)}">
               <apex:commandButton value="Save" action="{!save}" status="actionStatus"/>
               <apex:commandButton value="Expot To Pdf" action="{!renderPdf}"  status="actionStatus"/>
           </apex:pageBlockButtons> 
           
           <apex:pageBlockTable value="{!AWeathersList}" var="Weather">
               <apex:column headerValue="Time">
                   <apex:outputText value="{0,date,M/d/yyyy hh:mm a}">
                       <apex:param value="{!Weather.Dtime}"/>
                   </apex:outputText>
               </apex:column>
                <apex:column headerValue="Weather">
                   <apex:image style="vertical-align: middle;" value="http://api.openweathermap.org/img/w/{!Weather.weatherIcon }.png"  />{!Weather.weatherDescription}
               </apex:column>
               <apex:column headerValue="Temperature">
                   <apex:outputText value="{0, number, ###.0}Â°C">
                       <apex:param value="{!Weather.temperature}"/>
                   </apex:outputText>    
               </apex:column>
               <apex:column headerValue="Min/Max Temperature">
                   <apex:outputText value="{0, number, ###.0}">
                        <apex:param value="{!Weather.minTemp}"/>
                   </apex:outputText>
                   <apex:outputText value="/{0, number, ###.0}">
                        <apex:param value="{!Weather.maxTemp}"/>
                   </apex:outputText>  
               </apex:column>
               <apex:column headerValue="Pressure(hPa)">
                   <apex:outputText value="{0, number, ###.0}">
                       <apex:param value="{!Weather.pressure}"/>
                   </apex:outputText> 
               </apex:column>
               <apex:column headerValue="Air Speed">
                   <apex:outputText value="{0, number, ###.0}">
                       <apex:param value="{!Weather.airSpeed}"/>
                   </apex:outputText> 
               </apex:column>
               <apex:column headerValue="Humidity">
                   <apex:outputText value="{0, number, ###.0}%">
                       <apex:param value="{!Weather.humidity}"/>
                   </apex:outputText>    
               </apex:column>
           </apex:pageBlockTable>
           <apex:outputText rendered="{!if(WeathersList == null || WeathersList.size = 0,true, false)}" value="No records to display."/>
       </apex:pageBlock>
       
    </apex:form> 
   
</apex:page>